<html>
  <head>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.js"></script>
    <script>
      function init() {
        var request = {}
        $.ajax({
          type: 'POST',
          url: '/api/stats',
          contentType: 'application/json; charset=utf-8',
          dataType: 'json',
          data: JSON.stringify(request),
          success: function (data) {
            showActivity(data);
          },
          error: function (jqXHR, textStatus, error) {
            console.log('API request failed: ' + JSON.stringify(jqXHR));
          }
        });
      }
      
      function showActivity(esData) {
        let chart = {
          type: 'bar',
          data: {
            labels: [],
            datasets: [{
              label: 'Activity',
              data: [],
              backgroundColor: [],
              borderColor: [],
              borderWidth: 1
            }]
          },
          options: {
            responsive: false,
            scales: {
              yAxes: [{
                ticks: {
                  beginAtZero:true
                }
              }]
            }
          }
        }
        let labels = chart.data.labels;
        let dataset = chart.data.datasets[0];
        for (let bucket of esData.aggregations.action_date_range.buckets) {
          labels.push(bucket.key_as_string);
          dataset.data.push(bucket.doc_count);
          dataset.backgroundColor.push('rgba(255, 99, 132, 0.2)');
          dataset.borderColor.push('rgba(255,99,132,1)');
        }

        let ctx = document.getElementById("activity").getContext('2d');
        let activity = new Chart(ctx, chart);
      }
    </script>
  </head>
  <body onload="init()">
    <canvas id="activity" width="400" height="400"></canvas>
  </body>
</html>